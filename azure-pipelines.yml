trigger:
  branches:
    include:
    - main

pr:
  branches:
    include:
    - main

jobs:
- job: daalp4yConda
  strategy:
    matrix:
      ubuntu:
        imageName: 'ubuntu-20.04'
  pool:
    vmImage: $(imageName)
  steps:
  - script: |
      conda update -q -y conda
      conda create -q -y -n CB -c intel python=3.7 daal4py scikit-learn libxml2
      pip install pytest pandas
    displayName: 'Install daal4py'
  - script: |
      . /usr/share/miniconda/etc/profile.d/conda.sh
      conda activate CB
      export OCL_ICD_FILENAMES=libintelocl.so
      python -c "import daal4py"
      git clone https://github.com/IntelPython/daal4py.git
      python daal4py/examples/run_examples.py
      python -m daal4py daal4py/examples/sycl/sklearn_sycl.py
    displayName: 'Testing daal4py'
- job: daalp4yPyPi
  strategy:
    matrix:
      ubuntu:
        imageName: 'ubuntu-20.04'
  pool:
    vmImage: $(imageName)
  steps:
  - script: |
      pip install daal4py scikit-learn libxml2
      pip install pytest pandas
    displayName: 'Install daal4py'
  - script: |
      git clone https://github.com/IntelPython/daal4py.git
    displayName: 'Clone of daal4py'
  - script: |
      export OCL_ICD_FILENAMES=libintelocl.so
      python -c "import daal4py"
      # python daal4py/examples/run_examples.py
      python -m daal4py daal4py/examples/sycl/sklearn_sycl.py
    displayName: 'Testing daal4py'


